program test_thermodynamics
    use, intrinsic :: iso_fortran_env, only : dp => real64
    use thermo

    !============
    implicit none
    !============

    type(thermo_nasa7_t) :: species
    real(dp) :: cp
    
    print *, 'TEST: thermo'

    call set_mass_basis_flag(.true.)

    species = thermo_nasa7_t('CH4', 16.04300, 1000.00, &
         [+5.149876130000e+00, -1.367097880000e-02, +4.918005990000e-05, &
          -4.847430260000e-08, +1.666939560000e-11, -1.024664760000e+04, &
          -4.641303760000e+00], &
         [+7.485149500000e-02, +1.339094670000e-02, -5.732858090000e-06, &
          +1.222925350000e-09, -1.018152300000e-13, -9.468344590000e+03, &
          +1.843731800000e+01])
     
    species = thermo_nasa7_t('O2', 31.99800, 1000.00, &
         [+3.782456360000e+00, -2.996734160000e-03, +9.847302010000e-06, &
          -9.681295090000e-09, +3.243728370000e-12, -1.063943560000e+03, &
          +3.657675730000e+00], &
         [+3.282537840000e+00, +1.483087540000e-03, -7.579666690000e-07, &
          +2.094705550000e-10, -2.167177940000e-14, -1.088457720000e+03, &
          +5.453231290000e+00])
     
    species = thermo_nasa7_t('CO2', 44.00900, 1000.00, &
         [+2.356773520000e+00, +8.984596770000e-03, -7.123562690000e-06, &
          +2.459190220000e-09, -1.436995480000e-13, -4.837196970000e+04, &
          +9.901052220000e+00], &
         [+3.857460290000e+00, +4.414370260000e-03, -2.214814040000e-06, &
          +5.234901880000e-10, -4.720841640000e-14, -4.875916600000e+04, &
          +2.271638060000e+00])
     
    species = thermo_nasa7_t('H2O', 18.01500, 1000.00, &
         [+4.198640560000e+00, -2.036434100000e-03, +6.520402110000e-06, &
          -5.487970620000e-09, +1.771978170000e-12, -3.029372670000e+04, &
          -8.490322080000e-01], &
         [+3.033992490000e+00, +2.176918040000e-03, -1.640725180000e-07, &
          -9.704198700000e-11, +1.682009920000e-14, -3.000429710000e+04, &
          +4.966770100000e+00])
     
    species = thermo_nasa7_t('N2', 28.01400, 1000.00, &
         [+3.298677000000e+00, +1.408240400000e-03, -3.963222000000e-06, &
          +5.641515000000e-09, -2.444854000000e-12, -1.020899900000e+03, &
          +3.950372000000e+00], &
         [+2.926640000000e+00, +1.487976800000e-03, -5.684760000000e-07, &
          +1.009703800000e-10, -6.753351000000e-15, -9.227977000000e+02, &
          +5.980528000000e+00])

    cp = species%specific_heat(873.15)

    print *, cp

end program test_thermodynamics